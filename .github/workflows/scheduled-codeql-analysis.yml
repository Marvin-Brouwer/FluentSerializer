name: "Scheduled GitHub CodeQL"

on:
  schedule:
    - cron: '0 06 * * 0'
  workflow_dispatch:

permissions:
  contents: read

env:
  #https://github.com/dotnet/core/issues/4749#issuecomment-1332612225
  CLR_OPENSSL_VERSION_OVERRIDE: 3

jobs:
  analyze:
    name: Analyze
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    steps:
    ###
    # Checkout repository
    ###
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        lfs: true

    ###
    # ðŸ§° Initialize CodeQL
    #
    # Initializes the CodeQL tools for scanning.
    ###
    - name: ðŸ§° Initialize CodeQL
      uses: github/codeql-action/init@v2
      with:
        config-file: '${{github.workspace}}/.github/codeql/codeql-config.yml'
        languages: 'csharp'

    ###
    # ðŸ§° Setup .Net
    #
    # Configure the pipeline to use the correct .Net sdk versions
    ###
    - name: ðŸ§° Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: 9.0.x
    ###
    # ðŸ—ƒ Restore dependencies
    #
    # Fill the NuGet store with necessary libraries
    ###
    - name: ðŸ—ƒ Restore dependencies
      run: dotnet restore
    ###
    # ðŸ›  Build
    #
    # Build the library code for later use
    ###
    - name: ðŸ›  Build
      run: dotnet build --no-restore --nologo --configuration "Debug"
    ###
    # ðŸ”¬ Perform CodeQL Analysis
    ###
    - name: ðŸ”¬ Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v2
